<!DOCTYPE html>
<html lang="pt-br">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./index.css" />
    <link rel="icon" type="image/x-icon" href="./chronometer.png" />
    <title>Timer</title>
  </head>

  <body>
    <div class="timercontainer">
      <input
        type="number"
        value="0"
        name="hours"
        id="hoursfirst"
        placeholder="Horas"
        min="0"
        max="9"
      />
      <input
        type="number"
        value="0"
        name="hours"
        id="hourssecond"
        placeholder="Horas"
        min="0"
        max="9"
      />
      <span>:</span>
      <input
        type="number"
        value="0"
        name="minutes"
        id="minutesfirst"
        placeholder="Minutos"
        min="0"
        max="5"
      />
      <input
        type="number"
        value="0"
        id="minutessecond"
        name="minutes"
        placeholder="Minutos"
        min="0"
        max="9"
      />
      <span>:</span>
      <input
        type="number"
        value="0"
        name="seconds"
        id="secondsfirst"
        placeholder="Segundos"
        min="0"
        max="5"
      />
      <input
        type="number"
        value="0"
        name="seconds"
        id="secondssecond"
        placeholder="Segundos"
        min="0"
        max="9"
      />
    </div>
    <div class="actions">
      <button id="start">Iniciar</button>
      <button id="stop">Parar</button>
      <button id="reset">Reiniciar</button>
    </div>
    <script>
      let hoursfirst = document.getElementById("hoursfirst");
      let hourssecond = document.getElementById("hourssecond");
      let minutesfirst = document.getElementById("minutesfirst");
      let minutessecond = document.getElementById("minutessecond");
      let secondsfirst = document.getElementById("secondsfirst");
      let secondssecond = document.getElementById("secondssecond");

      let startButton = document.getElementById("start");
      let stopButton = document.getElementById("stop");
      let resetButton = document.getElementById("reset");

      let timerInterval;

      const validateInputs = (e) => {
        console.log(e.target.value);
        console.log(e.target.max);
        if (
          parseInt(e.target.value) > parseInt(e.target.max) ||
          parseInt(e.target.value) < parseInt(e.target.min)
        ) {
          e.target.value = 0;
        }
      };

      const inputs = document.querySelectorAll("input[type=number]");

      inputs.forEach((element) => {
        element.addEventListener("change", validateInputs);
      });

      const enableInputs = () => {
        inputs.forEach((element) => {
          element.removeAttribute("disabled");
        });
      };
      const disableInputs = () => {
        inputs.forEach((element) => {
          element.setAttribute("disabled", true);
        });
      };

      startButton.addEventListener("click", () => {
        let seconds = parseInt(secondsfirst.value + secondssecond.value);
        disableInputs();

        let totalSeconds =
          parseInt(hoursfirst.value + hourssecond.value) * 3600 +
          parseInt(minutesfirst.value + minutessecond.value) * 60 +
          parseInt(secondsfirst.value + secondssecond.value);

        timerInterval = setInterval(() => {
          if (totalSeconds <= 0) {
            clearInterval(timerInterval);
            return;
          }

          totalSeconds--;
          let hours = Math.floor(totalSeconds / 3600).toString();
          let minutes = Math.floor((totalSeconds % 3600) / 60).toString();
          let seconds = (totalSeconds % 60).toString();

          hoursfirst.value = hours.length > 1 ? hours.slice(0, 1) : "0";
          hourssecond.value = hours.length <= 1 ? hours : hours.slice(1);

          minutesfirst.value = minutes.length > 1 ? minutes.slice(0, 1) : "0";
          minutessecond.value =
            minutes.length <= 1 ? minutes : minutes.slice(1);

          secondsfirst.value = seconds.length > 1 ? seconds.slice(0, 1) : "0";
          secondssecond.value =
            seconds.length <= 1 ? seconds : seconds.slice(1);
        }, 1000);
      });

      stopButton.addEventListener("click", () => {
        clearInterval(timerInterval);
        enableInputs();
      });

      resetButton.addEventListener("click", () => {
        clearInterval(timerInterval);

        enableInputs();
        inputs.forEach((element) => {
          element.value = 0;
        });
      });
    </script>
    <script src="./index.js"></script>
  </body>
</html>
